(this.webpackJsonptree=this.webpackJsonptree||[]).push([[0],{15:function(e,t,n){e.exports={container:"Tree_container__14Gk0",canvasContainer:"Tree_canvasContainer__2vhw0"}},60:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(0),a=n.n(i),c=n(18),o=n.n(c),u=(n(60),n(15)),d=n.n(u),s=n(2),f=function(e){var t=a.a.useRef(null),n=a.a.useState([0,0,0,0]),i=Object(s.a)(n,2),c=i[0],o=i[1];return a.a.useEffect((function(){t.current&&o(function(e){var t=e.getBBox(),n=t.x,r=t.y,i=t.width,a=t.height;return[n,r,i,a]}(t.current))}),[]),Object(r.jsx)("svg",{ref:t,display:"block",height:e.height,width:e.width,viewBox:c.join(" "),children:e.children})};var l=n(9),h=(0,a.a.memo)((function(e){var t=a.a.useRef(null);return a.a.useEffect((function(){t.current&&function(e,t){var n=Object(l.a)(e);n.selectAll("g").remove();var r=n.append("g").attr("fill","none").attr("stroke","#555").attr("stroke-opacity",.4).attr("stroke-width",1.5),i=n.append("g"),a=n.append("g"),c=t.width/(t.tree.height+1),o=Object(l.c)().nodeSize([50,c])(t.tree);r.selectAll("path").data(o.links()).join("path").attr("stroke",(function(e){return t.selectedItemIds.has(String(e.target.id))?"blue":"#555"})).attr("d",(function(e){return"\n        M".concat(e.target.y,",").concat(e.target.x,"\n        C").concat(e.source.y+c/2,",").concat(e.target.x,"\n         ").concat(e.source.y+c/2,",").concat(e.source.x,"\n         ").concat(e.source.y,",").concat(e.source.x,"\n      ")})),i.selectAll("circle").data(o.descendants()).join("circle").attr("cx",(function(e){return e.y})).attr("cy",(function(e){return e.x})).attr("fill",(function(e){return e.children?"#555":"#999"})).attr("r",2.5),a.attr("font-family","sans-serif").attr("font-size",10).attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("text").data(o.descendants()).join("text").attr("x",(function(e){return e.y})).attr("y",(function(e){return e.x})).attr("dy","0.31em").attr("dx",(function(e){return e.children?-6:6})).attr("fill",(function(e){return e.id===t.highlightedItemId?"red":e.id&&t.selectedItemIds.has(e.id)?"blue":"black"})).text((function(e){return String(e.data[t.labelKey])})).filter((function(e){return!!e.children})).attr("text-anchor","end").clone(!0).lower().attr("stroke","white")}(t.current,e)}),[e]),Object(r.jsx)("g",{ref:t})})),v=function(){};var m=function(e){var t=e.autoFocus,n=e.eventListeners;return function(e){var t=a.a.useRef(v);return a.a.useCallback((function(n){t.current(),t.current=v,n&&(t.current=e(n))}),[e])}(a.a.useCallback((function(e){var r=[];return n.forEach((function(t){var n=t.keys,i=t.eventListener,a=function(e){n.includes(e.key)&&i(e)};r.push(a),null===e||void 0===e||e.addEventListener("keydown",a)})),t&&(null===e||void 0===e||e.focus()),function(){console.log("Cleanup time!"),r.forEach((function(t){null===e||void 0===e||e.removeEventListener("keydown",t)}))}}),[t,n]))};var p="hook-start",y="hook-end",g=function(e){var t=a.a.useMemo((function(){return t=e.items,n=e.idKey,r=e.parentKey,Object(l.b)().id((function(e){return String(e[n])})).parentId((function(e){return null===e[r]?"":String(e[r])}))(t);var t,n,r}),[e.items,e.idKey,e.parentKey]),n=e.useSelectedTreeFn;performance.mark(p);var i=n({items:e.items,itemKey:e.labelKey,tree:t}),c=i.search,o=i.onSearch,u=i.selectedItemIds;performance.mark(y),performance.measure("measure hook-start to hook-end",p,y),console.log("Hook performance (".concat(n.name,"): ").concat(performance.getEntriesByType("measure")[0].duration,"ms")),performance.clearMeasures();var v=function(e){var t=a.a.useState(e.tree.id),n=Object(s.a)(t,2),r=n[0],i=n[1],c=a.a.useMemo((function(){return[{keys:["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],eventListener:function(t){t.stopPropagation(),"ArrowRight"===t.key?i(function(e,t){var n=e.find((function(e){return e.id===t}));return n.children?n.children[0].id:t}(e.tree,r)):"ArrowLeft"===t.key?i(function(e,t){var n=e.find((function(e){return e.id===t}));return n.parent?n.parent.id:t}(e.tree,r)):"ArrowUp"===t.key?i(function(e,t){var n=e.find((function(e){return e.id===t})),r=[];e.each((function(e){e.depth===n.depth&&r.push(e)}));var i=r.findIndex((function(e){return e.id===n.id}));return r[i-1]?r[i-1].id:n.id}(e.tree,r)):"ArrowDown"===t.key&&i(function(e,t){var n=e.find((function(e){return e.id===t})),r=[];e.each((function(e){e.depth===n.depth&&r.push(e)}));var i=r.findIndex((function(e){return e.id===n.id}));return r[i+1]?r[i+1].id:n.id}(e.tree,r))}}]}),[r,e.tree]);return{hotkeyRef:m({autoFocus:!0,eventListeners:c}),highlightedItemId:r}}({tree:t});return Object(r.jsxs)("div",{className:d.a.container,tabIndex:0,ref:v.hotkeyRef,children:["Press arrow keys to navigate! ",Object(r.jsx)("br",{}),"Search:"," ",Object(r.jsx)("input",{type:"text",value:c,onChange:function(e){var t=e.currentTarget.value;o(t)}}),Object(r.jsx)("div",{className:d.a.canvasContainer,children:Object(r.jsx)(f,{height:e.height,width:e.width,children:Object(r.jsx)(h,{height:e.height,highlightedItemId:v.highlightedItemId,labelKey:e.labelKey,tree:t,selectedItemIds:u,width:e.width})})})]})},b=n(16),j=n(3);var w=0;function O(){var e=w+1;return w+=1,e}var x=function(e,t){var n=S({name:"Root",parentId:null});return[n].concat(k([n],e,t,1))};function k(e,t,n,r){return e.reduce((function(e,i){var a=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(j.a)(Array(e).keys()).map((function(e){return e+t}))}(n,1).map((function(n){return S({name:"Child item no. ".concat(n," parent_id: ").concat(e.id," depth: ").concat(t),parentId:e.id})}))}(i,r,n),c=[];return r<t&&(c=k(a,t,n,r+1)),[].concat(Object(j.a)(e),Object(j.a)(a),Object(j.a)(c))}),[])}function S(e){return Object(b.a)(Object(b.a)({},e),{},{id:O(),type:"folder"})}var I=n(63),K=function(e){var t=a.a.useState(""),n=Object(s.a)(t,2),r=n[0],c=n[1],o=a.a.useState(""),u=Object(s.a)(o,2),d=u[0],f=u[1];Object(I.a)((function(){f(r)}),200,[r]);var l=Object(i.useMemo)((function(){var t=new Set;return 0===d.length||e.tree.each((function(n){var r=n.data[e.itemKey];if("string"===typeof r&&r.toLocaleLowerCase().includes(d.toLowerCase())){var i=[n];"folder"===n.data.type&&n.children&&(i=i.concat(n.children)),i.forEach((function(n){e.tree.path(n).forEach((function(e){t.add(String(e.data.id))}))}))}})),t}),[e.itemKey,e.tree,d]);return{search:r,onSearch:function(e){c(""!==e?e:"")},selectedItemIds:l}};function C(e){var t=e.items,n=e.itemKey,r=e.options,i="";return{doSearch:function(e){return i=e,r&&r.caseSensitive?function(e,t,n){return e.reduce((function(e,r){var i=r[t];return"string"===typeof i&&i.includes(n)?[].concat(Object(j.a)(e),[r]):e}),[])}(t,n,e):function(e,t,n){return e.reduce((function(e,r){var i=r[t];return"string"===typeof i&&i.toLocaleLowerCase().includes(n.toLowerCase())?[].concat(Object(j.a)(e),[r]):e}),[])}(t,n,e)},search:i}}var L=function(e){var t=function(e){var t=C({items:e.items,itemKey:e.itemKey,options:e.options}),n=a.a.useState(""),r=Object(s.a)(n,2),c=r[0],o=r[1],u=a.a.useState(""),d=Object(s.a)(u,2),f=d[0],l=d[1];Object(I.a)((function(){l(c)}),200,[c]);var h=Object(i.useMemo)((function(){return""!==f?t.doSearch(f):[]}),[f,t]);return{debouncedSearch:f,search:c,filteredItems:h,onSearch:function(e){o(e)}}}({items:e.items,itemKey:e.itemKey}),n=t.filteredItems;return{search:t.search,onSearch:t.onSearch,selectedItemIds:a.a.useMemo((function(){var t,r,i=(t=n,r=e.tree,t.flatMap((function(e){if("folder"===e.type){var t=r.find((function(t){return String(t.id)===String(e.id)})),n=[t];return t.children?n.concat(t.children):n}return[r.find((function(t){return String(t.id)===String(e.id)}))]})));return function(e,t){return new Set(t.flatMap((function(t){return e.path(t)})).map((function(e){return String(e.id)})))}(e.tree,i)}),[n,e.tree])}};var A=function(){var e=a.a.useMemo((function(){return x(3,10)}),[]),t=e.length;console.log("items in data structure: ",t);var n=1e3;return t<100?n=800:t<2e3?n=4e4:t>2e3&&t<7e3?n=13e4:t>7e3&&(n=3e5),Object(r.jsxs)("div",{style:{display:"flex",width:"100%"},children:[Object(r.jsxs)("div",{children:["Optimised: (Or at least tries to be. Turns out it really isn't)",Object(r.jsx)(g,{height:n,idKey:"id",items:e,labelKey:"name",parentKey:"parentId",width:500,useSelectedTreeFn:K})]}),Object(r.jsxs)("div",{children:['"Un-optimised":',Object(r.jsx)(g,{height:n,idKey:"id",items:e,labelKey:"name",parentKey:"parentId",width:500,useSelectedTreeFn:L})]})]})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,64)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),i(e),a(e),c(e)}))};o.a.render(Object(r.jsx)(a.a.StrictMode,{children:Object(r.jsx)(A,{})}),document.getElementById("root")),M()}},[[62,1,2]]]);
//# sourceMappingURL=main.3ebee673.chunk.js.map